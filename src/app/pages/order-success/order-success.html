<!-- حالة التحميل -->
<div *ngIf="isLoading" class="loading-state">
  <div class="spinner-border" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
  <p>جاري تأكيد طلبك...</p>
</div>

<!-- بطاقة التأكيد (تظهر فقط بعد انتهاء التحميل) -->
<div *ngIf="!isLoading" class="confirmation-card">

  <!-- حالة النجاح (تظهر فقط إذا نجح الطلب وهناك بيانات) -->
  <div *ngIf="isSuccess && order" class="success-state">
    <div class="icon-wrapper">
      <i class="bi bi-patch-check-fill icon"></i>
    </div>
    <h1>شكراً لك، طلبك مؤكد!</h1>
    <p class="message">
      تم استلام طلبك بنجاح. رقم طلبك هو <strong>#{{ order.id }}</strong>
    </p>

    <!-- ملخص الطلب -->
    <div class="order-summary">
      <h4>ملخص الطلب</h4>
      <ul *ngIf="order.line_items" class="list-group">
        <li *ngFor="let item of order.line_items" class="list-group-item">
          <span class="item-details">{{ item.name }} (x{{ item.quantity }})</span>
          <span class="item-price">{{ item.total }}
            <svg class="riyal-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1124.14 1256.39" width="16" height="18" style="display:inline-block;vertical-align:-0.125em">
              <path fill="currentColor" d="M699.62,1113.02h0c-20.06,44.48-33.32,92.75-38.4,143.37l424.51-90.24c20.06-44.47,33.31-92.75,38.4-143.37l-424.51,90.24Z"></path>
              <path fill="currentColor" d="M1085.73,895.8c20.06-44.47,33.32-92.75,38.4-143.37l-330.68,70.33v-135.2l292.27-62.11c20.06-44.47,33.32-92.75,38.4-143.37l-330.68,70.27V66.13c-50.67,28.45-95.67,66.32-132.25,110.99v403.35l-132.25,28.11V0c-50.67,28.44-95.67,66.32-132.25,110.99v525.69l-295.91,62.88c-20.06,44.47-33.33,92.75-38.42,143.37l334.33-71.05v170.26l-358.3,76.14c-20.06,44.47-33.32,92.75-38.4,143.37l375.04-79.7c30.53-6.35,56.77-24.4,73.83-49.24l68.78-101.97v-.02c7.14-10.55,11.3-23.27,11.3-36.97v-149.98l132.25-28.11v270.4l424.53-90.28Z"></path>
            </svg>
          </span>
        </li>
        <li class="list-group-item total-row">
          <span>الإجمالي</span>
          <span>{{ order.total }}
            <svg class="riyal-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1124.14 1256.39" width="16" height="18" style="display:inline-block;vertical-align:-0.125em">
              <path fill="currentColor" d="M699.62,1113.02h0c-20.06,44.48-33.32,92.75-38.4,143.37l424.51-90.24c20.06-44.47,33.31-92.75,38.4-143.37l-424.51,90.24Z"></path>
              <path fill="currentColor" d="M1085.73,895.8c20.06-44.47,33.32-92.75,38.4-143.37l-330.68,70.33v-135.2l292.27-62.11c20.06-44.47,33.32-92.75,38.4-143.37l-330.68,70.27V66.13c-50.67,28.45-95.67,66.32-132.25,110.99v403.35l-132.25,28.11V0c-50.67,28.44-95.67,66.32-132.25,110.99v525.69l-295.91,62.88c-20.06,44.47-33.33,92.75-38.42,143.37l334.33-71.05v170.26l-358.3,76.14c-20.06,44.47-33.32,92.75-38.4,143.37l375.04-79.7c30.53-6.35,56.77-24.4,73.83-49.24l68.78-101.97v-.02c7.14-10.55,11.3-23.27,11.3-36.97v-149.98l132.25-28.11v270.4l424.53-90.28Z"></path>
            </svg>
          </span>
        </li>
      </ul>
    </div>

    <!-- الأزرار -->
    <div class="actions">
      <a routerLink="/" class="btn btn-secondary">مواصلة التسوق</a>
    </div>
  </div>

  <!-- حالة الفشل (تظهر فقط إذا فشل الطلب) -->
  <div *ngIf="!isSuccess" class="error-state">
    <div class="icon-wrapper">
      <i class="bi bi-x-octagon-fill icon"></i>
    </div>
    <h1>حدث خطأ ما</h1>
    <p class="message" *ngIf="error">
      {{ error }}
    </p>
    <div class="actions">
      <a routerLink="/checkout" class="btn btn-primary">المحاولة مرة أخرى</a>
    </div>
  </div>

</div>

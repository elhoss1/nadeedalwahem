<app-categories-bar></app-categories-bar>



<div class="dates-store-page">
  <div class="container">
    <header class="page-header">
      <h1 class="page-title">تمور مكنور ألي</h1>
      <p class="page-subtitle">أجود أنواع التمور المنتقاة بعناية من مزارعنا</p>
    </header>

    <div class="row">
      <!-- === الفلاتر والبحث (بتصميم جديد) === -->
      <aside class="col-lg-3">
        <div class="filters-sidebar">
          <!-- البحث -->
          <div class="filter-group">
            <label for="search" class="filter-label">ابحث عن تمر مفضل</label>
            <div class="search-wrapper">
              <input type="text" class="form-control search-input" placeholder="مثال: سكري، خلاص..." [(ngModel)]="searchTerm" (keyup.enter)="onSearch()">
              <button class="search-btn" type="button" (click)="onSearch()">
                <i class="fas fa-search"></i>
              </button>
            </div>
          </div>

          <!-- الترتيب -->
          <div class="filter-group">
            <label for="sort" class="filter-label">الترتيب حسب</label>
            <div class="select-wrapper">
              <select id="sort" class="form-select" [(ngModel)]="sortBy" (change)="onSortChange()">
                <option value="date">الأحدث وصولاً</option>
                <option value="price">السعر: من الأقل للأعلى</option>
                <option value="popularity">الأكثر طلباً</option>
              </select>
            </div>
          </div>
        </div>
      </aside>

      <!-- === قائمة المنتجات (بتصميم جديد) === -->
      <main class="col-lg-9">
        <!-- حالة التحميل -->
        <div *ngIf="isLoading" class="loading-state">
          <div class="spinner"></div>
          <p>جاري تحميل كنوز التمور...</p>
        </div>

        <!-- حالة وجود منتجات -->
        <div *ngIf="!isLoading && products.length > 0" class="products-grid">
          <div class="product-card" *ngFor="let product of products">
            <div class="product-image-wrapper">
              <img [src]="getProductImage(product)" class="product-image" [alt]="product.name">
              <div class="product-overlay">
                <a [routerLink]="['/products', product.id]" class="overlay-action details-btn">
                  <i class="fas fa-eye"></i>
                  <span>عرض التفاصيل</span>
                </a>
                <button class="overlay-action add-to-cart-btn" (click)="addToCart(product)">
                  <i class="fas fa-shopping-basket"></i>
                  <span>أضف للسلة</span>
                </button>
              </div>
            </div>
            <div class="product-info">
              <h3 class="product-name">{{ product.name }}</h3>
              <div class="product-price">{{ product.price}}
                <svg class="riyal-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1124.14 1256.39" width="16" height="18" style="display:inline-block;vertical-align:-0.125em">
                <path fill="currentColor" d="M699.62,1113.02h0c-20.06,44.48-33.32,92.75-38.4,143.37l424.51-90.24c20.06-44.47,33.31-92.75,38.4-143.37l-424.51,90.24Z"></path>
                <path fill="currentColor" d="M1085.73,895.8c20.06-44.47,33.32-92.75,38.4-143.37l-330.68,70.33v-135.2l292.27-62.11c20.06-44.47,33.32-92.75,38.4-143.37l-330.68,70.27V66.13c-50.67,28.45-95.67,66.32-132.25,110.99v403.35l-132.25,28.11V0c-50.67,28.44-95.67,66.32-132.25,110.99v525.69l-295.91,62.88c-20.06,44.47-33.33,92.75-38.42,143.37l334.33-71.05v170.26l-358.3,76.14c-20.06,44.47-33.32,92.75-38.4,143.37l375.04-79.7c30.53-6.35,56.77-24.4,73.83-49.24l68.78-101.97v-.02c7.14-10.55,11.3-23.27,11.3-36.97v-149.98l132.25-28.11v270.4l424.53-90.28Z"></path>
                </svg>
              </div>
            </div>
            <button class="mobile-add-to-cart" (click)="addToCart(product)">
              <i class="fas fa-cart-plus"></i> أضف للسلة
            </button>
          </div>
        </div>

        <!-- حالة عدم وجود منتجات -->
        <div *ngIf="!isLoading && products.length === 0" class="empty-state">
          <i class="far fa-sad-tear empty-icon"></i>
          <p>عفواً، لم نجد منتجات تطابق بحثك.</p>
          <p class="text-muted">جرّب كلمة بحث أخرى.</p>
        </div>
      </main>
    </div>
  </div>
</div>
